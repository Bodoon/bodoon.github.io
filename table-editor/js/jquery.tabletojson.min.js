!function(t){"use strict";t.fn.tableToJSON=function(n){n=t.extend({ignoreColumns:[2],onlyColumns:null,ignoreHiddenRows:!0,ignoreEmptyRows:!1,headings:null,allowHTML:!1,includeRowId:!1,textDataOverride:"data-override",extractor:null,textExtractor:null},n);var e,r,o,i,l,a,s,u,d,f,c,h,g,p,y,m,w,v=function(t){return null!=t},x=function(e){return v(n.onlyColumns)?-1===t.inArray(e,n.onlyColumns):-1!==t.inArray(e,n.ignoreColumns)},C=function(e,r,o){var i,l=t(r),a=n.extractor||n.textExtractor,s=l.attr(n.textDataOverride);return null===a||o?t.trim(s||(n.allowHTML?l.html():r.textContent||l.text())||""):t.isFunction(a)?"string"==typeof(i=s||a(e,l))?t.trim(i):i:"object"==typeof a&&t.isFunction(a[e])?"string"==typeof(i=s||a[e](e,l))?t.trim(i):i:t.trim(s||(n.allowHTML?l.html():r.textContent||l.text())||"")},I=(a=this.find("tr:first").first(),v(n.headings)?n.headings:(e=a,r=!0,o=[],i=n.includeRowId,l="string"==typeof i==1?i:"rowId",("boolean"==typeof i?i:"string"==typeof i)&&void 0===t(e).attr("id")&&o.push(l),t(e).children("td,th").each(function(t,n){o.push(C(t,n,r))}),o));for(var R in I)I[R]=I[R].toLowerCase();return s=I,y=[],m=0,w=[],this.children("tbody,*").children("tr").each(function(e,r){if(e>0||v(n.headings)){var o=n.includeRowId,i="boolean"==typeof o?o:"string"==typeof o,l=(g=t(r)).find("td").length===g.find("td:empty").length;!g.is(":visible")&&n.ignoreHiddenRows||l&&n.ignoreEmptyRows||g.data("ignore")&&"false"!==g.data("ignore")||(m=0,y[e]||(y[e]=[]),i&&(m+=1,void 0!==g.attr("id")?y[e].push(g.attr("id")):y[e].push("")),g.children().each(function(){for(p=t(this);y[e][m];)m++;if(p.filter("[rowspan]").length)for(f=parseInt(p.attr("rowspan"),10)-1,h=C(m,p),u=1;u<=f;u++)y[e+u]||(y[e+u]=[]),y[e+u][m]=h;if(p.filter("[colspan]").length)for(f=parseInt(p.attr("colspan"),10)-1,h=C(m,p),u=1;u<=f;u++)if(p.filter("[rowspan]").length)for(c=parseInt(p.attr("rowspan"),10),d=0;d<c;d++)y[e+d][m+u]=h;else y[e][m+u]=h;h=y[e][m]||C(m,p),v(h)&&(y[e][m]=h),m++}))}}),t.each(y,function(e,r){if(v(r)){var o=v(n.onlyColumns)||n.ignoreColumns.length?t.grep(r,function(t,n){return!x(n)}):r,i=v(n.headings)?s:t.grep(s,function(t,n){return!x(n)});l=i,a=o,u={},d=0,t.each(a,function(t,n){var e;d<l.length&&v(n)&&(void 0!==(e=l[d])&&e.length>0&&(u[l[d]]=n),d++)}),h=u,w[w.length]=h}var l,a,u,d}),w}}(jQuery);